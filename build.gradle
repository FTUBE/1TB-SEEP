subprojects {
	// system version 
	version = version 

	apply plugin: 'java'
	sourceCompatibility = JavaVersion.VERSION_1_8
	targetCompatibility = JavaVersion.VERSION_1_8
	apply plugin: 'eclipse'

	repositories {
		mavenCentral()
	}

	dependencies {
		compile 'org.slf4j:slf4j-api:1.7.5'
		compile 'ch.qos.logback:logback-classic:1.0.13'
		compile 'net.sf.jopt-simple:jopt-simple:4.8'
		compile 'com.esotericsoftware:kryo:3.0.0'
		compile 'commons-cli:commons-cli:1.2'
		compile 'io.dropwizard.metrics:metrics-core:3.1.0'

		testCompile 'junit:junit:4.11'
	}
}

// Create a distribution
task standaloneDist() << {
	description "Compiles and creates distribution of the system"
	File dist = mkdir("$customDistDir/standaloneDist")
	subprojects.each {project ->
        	project.tasks.withType(Jar).each {archiveTask ->
            		copy {
                		from archiveTask.archivePath
                		into dist 
            		}
        	}
	}
	println "Created system distribution in $customDistDir/dist !!"
}

// Overrides clean task to delete dist directory
task clean << {
	// generated by standaloneDist task
	delete "$customDistDir/standaloneDist"
	// generated by installApp task
	delete "$projectDir/install"
	// generated by distZip task
	delete "$projectDir/dist"
}

task wrapper(type: Wrapper) {
	gradleVersion = '2.1'
}
